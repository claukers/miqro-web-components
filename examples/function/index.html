<!DOCTYPE html>
<html>
<body>
<root-component>
  <label-fn></label-fn>
</root-component>
<script type="module">
  import {defineFunction, Component} from "./lib/index.js";

  /*customElements.define("label-fn", class extends Component {
    click() {
      console.log("click")
    }
    render() {
      return '<p data-on-click="{this.click}">p</p>';
    }
  })*/

  defineFunction("root-component", function () {
    const [showChildren, setShowChildren] = this.useState(true);
    console.log("showChildren %s", showChildren);
    return {
      template: `<p data-on-click="{toggleShow}">children start</p><div data-if="{showChildren}">{children}</div><p>children end</p>`,
      values: {
        showChildren,
        toggleShow: (ev) => {
          ev.preventDefault();
          console.log("set showChildren %s", !showChildren);
          setShowChildren(!showChildren);
        }
      }
    }
  }, false)

  defineFunction("label-fn", async function () {
    const [count, setCount] = this.useState(0);
    console.log("render " + count);
    this.useEffect(() => {
      console.log("effect on");
      return () => {
        console.log("effect off");
      }
    });
    return {
      template: '<p data-on-click="{click}">click count {count}</p>',
      values: {
        count,
        click: function (ev) {
          //console.dir(ev);
          ev.preventDefault();
          console.log("calling setCount with " + (count + 1));
          setCount(count + 1);
        }
      }
    }
  }, false);

</script>
</body>
</html>
